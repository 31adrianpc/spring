<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/images/icons/favicon.ico"/>
    <link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/vendor/animate/animate.css">
    <link rel="stylesheet" type="text/css" href="/vendor/css-hamburgers/hamburgers.min.css">
    <link rel="stylesheet" type="text/css" href="/vendor/select2/select2.min.css">
    <link rel="stylesheet" type="text/css" href="/css/util.css">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <title>Document</title>
</head>
<body>
    <a th:href="@{/logout}" class="btn btn-outline-danger"><i class="bi bi-box-arrow-left"></i> Salir</a>
    <div class="container-fluid">
        <div class="row">
            <div class="col-4 mx-auto">
                <h1>Mantenimiento Usuario</h1>
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr class="table-dark">
                            <th>User</th>
                            <th>Nombre y Apellido</th>
                            <th>Foto</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="usuario : ${listaUsuarios}">
                            <td th:text="${usuario.user}"></td>
                            <td th:text="${usuario.nombreApellido}"></td>
                            <!-- El navegador no puede manejar datos binarios. data:image/jpeg;base64 le indica
                                que el contenido es una imagen en formato Base64 -->
                            <td>
                                <img th:if="${usuario.foto}" width="50px" height="50px" th:src="'data:image/jpeg;base64, ' + ${usuario.fotoBase64}">
                            </td>
                            <td>
                                <a class="btn btn-warning" th:href="'/admin/actualizarUsuario?idUsuario=' + ${usuario.idUsuario}"><i class="bi bi-arrow-clockwise"></i></a>
                                <a class="btn btn-danger" th:href="'/admin/eliminarUsuario?idUsuario=' + ${usuario.idUsuario}"><i class="bi bi-trash"></i></a>
                            </td> 
                        </tr>
                    </tbody>
                </table>
                <br>
                <label th:if="${msgExito}" style="color:blue"></label>
                <label th:if="${msgError}" style="color:red"></label>
                <br>
                <a class="btn btn-primary" th:href="'/admin/mantenimientoUsuarios'">Limpiar</a>
            </div>
        </div>
    </div>
    
    <div class="container-fluid">
        <div class="row">
            <div class="col-4 mx-auto">
                <h1> <label th:if="${operacion}">ACTUALIZAR</label> <label th:unless="${operacion}">REGISTRAR</label> USUARIO</h1>
                <form class="form-control" action="/admin/grabarUsuario" th:object="${usuarioBean}" enctype="multipart/form-data" method="post">
                    <fieldset>
                        <table>
                            <tr>
                                <td>
                                    <label for="user" class="form-label">Usuario:</label>
                                </td>
                                <td>
                                    <input th:field="*{user}" type="text" class="form-control"/>
                                    <input hidden th:field="*{idUsuario}"/>
                                    <input hidden th:field="*{estado}"/>
                                    <!-- name accion es lo que nos permite recuperar la accion.
                                    name=accion define el nombre del parametro que se enviará
                                    en la petición HTTP y value su valor.-->
                                    <input type="text" hidden th:value="${accion}">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="password">Contraseña:</label>
                                </td>
                                <td>
                                    <input th:field="*{password}" type="text" class="form-control"/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="nombreApellido">Nombre y apellidos:</label>
                                </td>
                                <td>
                                    <input th:field="*{nombreApellido}" type="text" class="form-control"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="text-center">
                                    <input type="submit" value="Grabar" class="btn btn-dark"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <label th:text="${msgError}" style="color:red"></label>
                                </td>
                            </tr>
                        </table>
                    </fieldset>
                </form>
            </div>
        </div>
    </div>

</body>
</html>